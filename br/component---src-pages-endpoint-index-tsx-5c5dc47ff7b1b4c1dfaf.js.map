{"version":3,"file":"component---src-pages-endpoint-index-tsx-5c5dc47ff7b1b4c1dfaf.js","mappings":"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","sources":["webpack://deriv-com/./src/components/hooks/use-localstorage-state.tsx","webpack://deriv-com/./src/pages/endpoint/index.tsx","webpack://deriv-com/./src/common/validation.js"],"sourcesContent":["import { useState, useEffect } from 'react'\nimport { isBrowser, isNullUndefined, parseJSONString } from 'common/utility'\n\nexport const useLocalStorageState = (defaultValue, key) => {\n    const [value, setValue] = useState(() => {\n        const sticky_value = isBrowser() ? window.localStorage.getItem(key) : null\n        return sticky_value ? parseJSONString(sticky_value) : defaultValue\n    })\n\n    useEffect(() => {\n        if (isBrowser()) {\n            if (isNullUndefined(value)) {\n                window.localStorage.removeItem(key)\n            } else {\n                window.localStorage.setItem(key, value)\n            }\n        }\n    }, [key, value])\n\n    return [value, setValue]\n}\n","import * as React from 'react'\nimport styled from 'styled-components'\nimport { Formik, Form } from 'formik'\nimport device from 'themes/device'\nimport { WithIntl } from 'components/localization'\nimport Layout from 'components/layout/layout'\nimport { Container, SEO } from 'components/containers'\nimport { Header, Text } from 'components/elements'\nimport { Input, Button } from 'components/form'\nimport validation from 'common/validation'\nimport { trimSpaces } from 'common/utility'\nimport { default_server_url } from 'common/constants'\nimport { getAppId } from 'common/websocket/config'\nimport { DerivStore } from 'store'\nimport { useLocalStorageState } from 'components/hooks/use-localstorage-state'\n\ntype ValuesType = {\n    server_url?: string\n    app_id?: string\n    clients_country?: string\n}\n\ntype ActionsType = {\n    setSubmitting: (arg0: boolean) => void\n    setStatus: (arg0: { message?: string }) => void\n}\n\nconst StyledInput = styled(Input)`\n    & ~ label {\n        transform: translate(-0.6rem, -2rem) scale(0.7);\n        color: var(--color-black-3);\n        background-color: ${({ background }) =>\n            background ? `var(--color-${background})` : 'var(--color-grey-1)'};\n\n        @media ${device.tabletL} {\n            top: 9px;\n        }\n    }\n`\n\nconst StyledContainer = styled(Container)`\n    text-align: center;\n    height: 100vh;\n    padding: auto 0;\n    justify-content: start;\n`\n\nconst ButtonContainer = styled.div`\n    margin-top: 2rem;\n`\n\nconst InputGroup = styled.div`\n    width: 40rem;\n    margin: 0 auto 3.4rem;\n\n    & > div {\n        margin-bottom: 1rem;\n    }\n    & > div:last-child {\n        margin-bottom: 0;\n    }\n`\n\nconst StyledButton = styled(Button)`\n    margin: 0.8rem 0.4rem;\n`\n\nconst endpointValidation = (values: ValuesType) => {\n    const errors: ValuesType = {}\n\n    const server_url = trimSpaces(values ? values.server_url : '')\n    const app_id = trimSpaces(values ? values.app_id.toString() : '')\n    const clients_country = trimSpaces(values ? values.clients_country.toString() : '')\n    const server_url_error =\n        validation.required(server_url) ||\n        validation.url(server_url, 'Please enter a valid server URL')\n    const app_id_error =\n        validation.required(app_id) || validation.number(app_id, 'Please enter a valid app ID')\n    const clients_country_error =\n        validation.required(clients_country) || validation.alphabetic(clients_country)\n\n    if (server_url_error) {\n        errors.server_url = server_url_error\n    }\n\n    if (app_id_error) {\n        errors.app_id = app_id_error\n    }\n\n    if (clients_country_error) {\n        errors.clients_country = clients_country_error\n    }\n\n    return errors\n}\n\nconst Endpoint = () => {\n    const [server_url, setServerUrl] = useLocalStorageState(default_server_url, 'config.server_url')\n    const [app_id, setAppId] = useLocalStorageState(getAppId(), 'config.app_id')\n    const [reset_loading, setResetLoading] = React.useState(false)\n    const { website_status, setWebsiteStatus, website_status_loading } =\n        React.useContext(DerivStore)\n    const STATUS_TIMEOUT_DELAY = 1500\n    const RESET_TIMEOUT_DELAY = 500\n\n    const handleStatus = (setStatus: (arg0: { message?: string }) => void, message: string) => {\n        setStatus({ message })\n        setTimeout(() => {\n            setStatus({})\n        }, STATUS_TIMEOUT_DELAY)\n    }\n    const resetEndpointSettings = (setStatus: (status?: unknown) => void) => {\n        // reset local storage values\n        setResetLoading(true)\n        setServerUrl()\n        setAppId()\n        // adding the default storage values\n        setTimeout(() => {\n            setServerUrl(default_server_url)\n            setAppId(getAppId())\n            setResetLoading(false)\n        }, RESET_TIMEOUT_DELAY)\n        // reset website status values\n        setWebsiteStatus()\n        handleStatus(setStatus, 'Config has been reset successfully')\n        // TODO: if there is a change requires reload in the future\n        // window.location.reload()\n    }\n    const endpointSubmission = (values: ValuesType, actions: ActionsType) => {\n        actions.setSubmitting(true)\n        setServerUrl(values.server_url)\n        setAppId(values.app_id)\n\n        // handle website status changes\n        const new_website_status = { ...website_status, clients_country: values.clients_country }\n        setWebsiteStatus(new_website_status)\n        actions.setSubmitting(false)\n        handleStatus(actions.setStatus, 'Config has been updated')\n        // TODO: if there is a change requires reload in the future\n        window.location.reload()\n    }\n\n    return (\n        <Layout type=\"static\" margin_top={'0'}>\n            <SEO title=\"Endpoint\" description=\"Change deriv API endpoint.\" no_index />\n            <StyledContainer justify=\"center\" align=\"center\" direction=\"column\">\n                <Header as=\"h2\" type=\"page-title\" align=\"center\" mt=\"80px\">\n                    Change API endpoint\n                </Header>\n                <Header\n                    as=\"h4\"\n                    type=\"sub-section-title\"\n                    align=\"center\"\n                    weight=\"500\"\n                    mt=\"0.5rem\"\n                    mb=\"3.8rem\"\n                >\n                    Update configuration for API endpoint or other settings\n                </Header>\n                <Formik\n                    initialValues={{\n                        server_url: server_url ? server_url : '',\n                        app_id: app_id ? app_id : '',\n                        // this implicit check is required by formik for `enableReinitialize` to work\n                        clients_country: website_status?.clients_country\n                            ? website_status?.clients_country\n                            : '',\n                    }}\n                    enableReinitialize={true}\n                    validate={endpointValidation}\n                    onSubmit={endpointSubmission}\n                >\n                    {({\n                        values,\n                        errors,\n                        handleChange,\n                        handleBlur,\n                        isSubmitting,\n                        setStatus,\n                        setFieldValue,\n                        isValid,\n                        dirty,\n                        touched,\n                        status,\n                    }) => (\n                        <Form noValidate>\n                            <InputGroup>\n                                <StyledInput\n                                    name=\"server_url\"\n                                    error={errors.server_url}\n                                    value={values.server_url}\n                                    disabled={reset_loading}\n                                    handleError={() => setFieldValue('server_url', '')}\n                                    onChange={handleChange}\n                                    onBlur={handleBlur}\n                                    type=\"text\"\n                                    label=\"Server URL\"\n                                    background=\"white\"\n                                    placeholder={'e.g. green.binaryws.com'}\n                                />\n                                <StyledInput\n                                    name=\"app_id\"\n                                    error={errors.app_id}\n                                    value={values.app_id}\n                                    disabled={reset_loading}\n                                    handleError={() => setFieldValue('app_id', '')}\n                                    onChange={handleChange}\n                                    onBlur={handleBlur}\n                                    type=\"text\"\n                                    label=\"App ID\"\n                                    background=\"white\"\n                                    placeholder={'e.g. 9999'}\n                                />\n                                <StyledInput\n                                    name=\"clients_country\"\n                                    error={errors.clients_country}\n                                    value={values.clients_country}\n                                    disabled={website_status_loading}\n                                    handleError={() => setFieldValue('clients_country', '')}\n                                    onChange={handleChange}\n                                    onBlur={handleBlur}\n                                    type=\"text\"\n                                    label=\"Clients country\"\n                                    background=\"white\"\n                                    placeholder={'e.g. mt (for EU) or gb (for UK) or za (for P2P)'}\n                                />\n                            </InputGroup>\n                            <Text align=\"center\" color=\"green\">\n                                {status?.message && status.message}\n                            </Text>\n                            <ButtonContainer>\n                                <StyledButton\n                                    tertiary\n                                    onClick={() => resetEndpointSettings(setStatus)}\n                                    type=\"button\"\n                                >\n                                    Reset to original settings\n                                </StyledButton>\n                                <StyledButton\n                                    secondary=\"true\"\n                                    disabled={isSubmitting || !dirty || !touched || !isValid}\n                                    type=\"submit\"\n                                >\n                                    Submit changes\n                                </StyledButton>\n                            </ButtonContainer>\n                        </Form>\n                    )}\n                </Formik>\n            </StyledContainer>\n        </Layout>\n    )\n}\n\nexport default WithIntl()(Endpoint)\n","import { localize } from 'components/localization'\n\nconst validation_regex = {\n    email: /^[^@]+@[^@]+\\.[^@.]{2,}$/,\n    url: /^[\\w|\\-|.]+$/,\n    alphabetic: /^[a-zA-Z]+$/,\n    number: /^\\d+$/,\n}\n\nconst validation = {\n    // Validation will return a string for error message\n    email: (input, message) => {\n        if (!validation_regex.email.test(input)) {\n            return message ? message : localize('Email is required')\n        } else {\n            return null\n        }\n    },\n    name: (input, message) => {\n        if (!input) {\n            return message ? message : localize('Name is required')\n        } else {\n            return null\n        }\n    },\n    required: (input, message) => {\n        if (!input) {\n            return message ? message : localize('This field is required')\n        } else {\n            return null\n        }\n    },\n    url: (input, message) => {\n        if (!validation_regex.url.test(input)) {\n            return message ? message : localize('Please enter a valid URL format')\n        } else {\n            return null\n        }\n    },\n    number: (input, message) => {\n        if (!validation_regex.number.test(input)) {\n            return message ? message : localize('Please enter a valid number')\n        } else {\n            return null\n        }\n    },\n    alphabetic: (input, message) => {\n        if (!validation_regex.alphabetic.test(input)) {\n            return message ? message : localize('Please enter only alphabetic characters')\n        } else {\n            return null\n        }\n    },\n}\n\nexport default validation\n"],"names":["useLocalStorageState","defaultValue","key","useState","sticky_value","isBrowser","window","localStorage","getItem","parseJSONString","value","setValue","useEffect","isNullUndefined","removeItem","setItem","StyledInput","styled","Input","withConfig","background","device","StyledContainer","Container","ButtonContainer","InputGroup","StyledButton","Button","endpointValidation","values","errors","server_url","trimSpaces","app_id","toString","clients_country","server_url_error","validation","app_id_error","clients_country_error","WithIntl","default_server_url","setServerUrl","getAppId","setAppId","React","reset_loading","setResetLoading","DerivStore","website_status","setWebsiteStatus","website_status_loading","handleStatus","setStatus","message","setTimeout","Layout","type","margin_top","SEO","title","description","no_index","justify","align","direction","Header","as","mt","weight","mb","Formik","initialValues","enableReinitialize","validate","onSubmit","actions","setSubmitting","new_website_status","location","reload","handleChange","handleBlur","isSubmitting","setFieldValue","isValid","dirty","touched","status","Form","noValidate","name","error","disabled","handleError","onChange","onBlur","label","placeholder","Text","color","tertiary","onClick","resetEndpointSettings","secondary","validation_regex","email","url","alphabetic","number","input","test","localize","required"],"sourceRoot":""}